时间： 2024-11-20 15:13:13

参考：

## 

服务调用

![](../../../img/architecture/service_invoke.png)

服务间的调用关系如图所示，想要记录服务间的调用关系，有两种方式：

**方式一：** 调用发起方。在服务调用其它服务开始时记录一条日志，结束时记录一条日志。这样能记录一个服务的耗时。记录不可扩展的第三方的组件的调用耗时，如数据库、Redis 和 消息队列等组件的服务耗时。

服务每次调用分为若干个Span，不打印总耗时。

**方式二：** 被调用方。被调用方记录调用开始和调用结束的耗时。这种方式适用于自己维护的服务。对于数据库、Kafka 和消息队列等组件修改源代码比较麻烦。


需要考虑的点：多线程的时候怎么处理

按当前服务日志打印时间排序。

|AA|BB|
|::|::|
|||